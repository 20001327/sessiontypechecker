# Three Buyer Protocol

In this example we show the simple three-buyer-protocol with delegation, then we get the abstract syntax three 
generated by the erlang compiler and parsing the extracted files with jastadd we want to 
build a typechecker.

Jastadd is a simple modular expression evaluator. It uses several components,
focusing on the use of [JastAdd](http://jastadd.org) system, with AST and aspects definition.
The scanner class is generated by the JFlex scanner generator tool, and the
parser class is generated by the Beaver LALR parser generator tool.

External dependencies are self contained in the `tools` directory, except
for Ant.


By creating new aspects (`.jrag` and `.jadd` files) the translator can be
extended with new functionalities. Furthermore, concrete and abstract syntax
can be extended or modified by editing `.jflex`, `.parser` and `.ast` files
in the `spec` directory.

The Ant `build.xml` reflects the most updated features for all external
packages we use; for example it demonstrates how to use JastAddParser
(Beaver preprocessor) and JastAdd (which have currently no built-in Ant
support).

## Before running

Before running we have to generate the ast from erland. to do this open terminal in src folder
and then open erl with
    
    $ erl

then compile all with

    $ make:all().

and extract ast with

    $ forms:get_ast().

## Building

Just run

	$ ant build

to build a working jar file in the `jar` directory. then execute by simple java command

    $ java -jar threeBuyer.jar <AST-DIR>

where <AST-DIR> have to be replaced with the directory cointaing erlang extracted ast
## Cleaning

Run

	$ ant clean

to clean up the project tree.
If you encounter some problems on Cygwin environment, try to add the `-v` flag.

## using forms for generate ast files

In the previous example we use make:all() and form:get_ast() to get the ast. If you want to test 
the typechecker with other protocol, you have to compile your actors source file with debug option, 
for example typing in cmd:
    
    $ erlc +debug_info file.erl
and then with forms module extract the ast. in erlang terminal:

    $ read_to_binary(file,"ast/file.ast"),
